(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["dialer","ninjacapture28"],{"2ae6":function(module,__webpack_exports__,__webpack_require__){"use strict";var regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("96cf"),regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_0__),_home_agile_Desktop_Office_public_infi_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("1da1"),_home_agile_Desktop_Office_public_infi_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("d4ec"),_home_agile_Desktop_Office_public_infi_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("bee2"),_home_agile_Desktop_Office_public_infi_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("262e"),_home_agile_Desktop_Office_public_infi_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("2caf"),axios__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("bc3a"),axios__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_6__),_jwt__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("9b7b"),_core_data__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("a11a"),CallBack_Server="https://api.${region}.500apps.com/pbxplus/v1/save-contact-info",CallBack=function(_Data){Object(_home_agile_Desktop_Office_public_infi_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__["a"])(CallBack,_Data);var _super=Object(_home_agile_Desktop_Office_public_infi_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_5__["a"])(CallBack);function CallBack(){return Object(_home_agile_Desktop_Office_public_infi_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__["a"])(this,CallBack),_super.apply(this,arguments)}return Object(_home_agile_Desktop_Office_public_infi_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_3__["a"])(CallBack,[{key:"add",value:function(){var _add=Object(_home_agile_Desktop_Office_public_infi_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__["a"])(regeneratorRuntime.mark((function _callee(form){var headers,region,url,response;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_jwt__WEBPACK_IMPORTED_MODULE_7__["a"].setHeader();case 2:return headers=_context.sent,region=this.getRegion(),url=CallBack_Server,url=eval("`"+url+"`"),_context.next=8,axios__WEBPACK_IMPORTED_MODULE_6___default.a.post(url,form,{headers:headers});case 8:return response=_context.sent,_context.abrupt("return",response.data);case 10:case"end":return _context.stop()}}),_callee,this)})));function add(e){return _add.apply(this,arguments)}return add}()}]),CallBack}(_core_data__WEBPACK_IMPORTED_MODULE_8__["a"]);__webpack_exports__["a"]=new CallBack},a78e:function(e,t,a){var n,r;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */(function(i){var s;if(n=i,r="function"===typeof n?n.call(t,a,t,e):n,void 0===r||(e.exports=r),s=!0,e.exports=i(),s=!0,!s){var o=window.Cookies,_=window.Cookies=i();_.noConflict=function(){return window.Cookies=o,_}}})((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var a=arguments[e];for(var n in a)t[n]=a[n]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function a(n){function r(){}function i(t,a,i){if("undefined"!==typeof document){i=e({path:"/"},r.defaults,i),"number"===typeof i.expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var s=JSON.stringify(a);/^[\{\[]/.test(s)&&(a=s)}catch(c){}a=n.write?n.write(a,t):encodeURIComponent(String(a)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var o="";for(var _ in i)i[_]&&(o+="; "+_,!0!==i[_]&&(o+="="+i[_].split(";")[0]));return document.cookie=t+"="+a+o}}function s(e,a){if("undefined"!==typeof document){for(var r={},i=document.cookie?document.cookie.split("; "):[],s=0;s<i.length;s++){var o=i[s].split("="),_=o.slice(1).join("=");a||'"'!==_.charAt(0)||(_=_.slice(1,-1));try{var c=t(o[0]);if(_=(n.read||n)(_,c)||t(_),a)try{_=JSON.parse(_)}catch(l){}if(r[c]=_,e===c)break}catch(l){}}return e?r[e]:r}}return r.set=i,r.get=function(e){return s(e,!1)},r.getJSON=function(e){return s(e,!0)},r.remove=function(t,a){i(t,"",e(a,{expires:-1}))},r.defaults={},r.withConverter=a,r}return a((function(){}))}))},b9ba:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Header",{attrs:{domain_id:e.domain_id,variant:e.variant,buttonName:e.buttonName,from:"visitor"},on:{visitor_click:e.prefer}}),"call_back"==e.visitor_select?a("CallBack",{attrs:{call_flow_id:e.flow_id,api_key:e.api_key,domain_id:e.domain_id}}):e._e(),"call_now"==e.visitor_select?a("div",["connected"==e.status?a("div",{staticClass:"width-400"},[a("b-card",{staticClass:"h-100 bg-dailer rounded-20",attrs:{"body-class":"dailer-padding"}},["visitor"!=e.$route.params.from?a("div",{staticClass:"d-flex justify-content-center"},[a("img",{staticClass:"avatar rounded-circle mb-3",attrs:{src:"https://infinity.500apps.com/avatars/avatar-47.png"}})]):e._e(),a("Timer",{attrs:{domain_id:e.domain_id,connection:e.connection}}),a("KeyPad",{attrs:{domain_id:e.domain_id},on:{digitPressed:e.digitPressed}})],1),a("HangupCall")],1):e._e()]):e._e()],1)},r=[],i=(a("99af"),a("d3b7"),a("25f0"),a("96cf"),a("1da1")),s=a("5530"),o=a("2f62"),_=a("89c7"),c=a("c18d"),l=a("73c2"),u=a("9846"),d=a("2cfc"),m=a("f086"),p={components:{CallBack:m["default"],Header:_["default"],HangupCall:c["default"],KeyPad:l["default"],Timer:u["default"]},props:{flow_id:String,api_key:String,domain_id:String},data:function(){return{status:"",connectedCall:!1,visitor_select:"",connection:"",buttonName:"Call from Computer",variant:"success"}},computed:Object(s["a"])({},Object(o["b"])(["isTwilioReady","device","checkDeviceStatus"])),watch:{checkDeviceStatus:function(e){"connect"===e&&(this.connectedCall=!0,this.status="connected")}},mounted:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d["a"].getCapabilityVisitor(this.domain_id,this.flow_id,this.api_key);case 3:t=e.sent,this.$store.dispatch("getToken","".concat(t[0].pref_value,"?To=PBX_Guest_").concat(Math.floor(1e5*Math.random()))),e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}(),methods:{initiateCall:function(){this.connection=this.device.connect({callflow_id:this.flow_id,domain_id:this.domain_id,api_key:this.api_key}),this.$store.dispatch("twilioDeviceListeners"),this.twilioConnection=this.connection},digitPressed:function(e){this.twilioConnection.sendDigits(e.toString())},disconnect_call:function(){this.device.disconnectAll(),this.connectedCall=!1,this.status=""},prefer:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if("call_now"!=t.visitor_select||"call_now"!=e){a.next=5;break}return t.disconnect_call(),t.buttonName="Call from Computer",t.variant="success",a.abrupt("return");case 5:if(t.visitor_select=e,"call_now"!=t.visitor_select){a.next=13;break}return a.next=9,t.initiateCall();case 9:t.buttonName="Calling..",t.variant="danger",a.next=16;break;case 13:t.disconnect_call(),t.buttonName="Call from Computer",t.variant="success";case 16:case"end":return a.stop()}}),a)})))()}}},f=p,b=a("2877"),h=Object(b["a"])(f,n,r,!1,null,null,null);t["default"]=h.exports},c5f4:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",["new"==e.status?a("div",{staticClass:"loading-content"},[a("b-spinner",{attrs:{variant:"primary",label:"Spinning"}})],1):e._e(),"permission_pending"==e.status?[a("PermissionMessage")]:e._e(),"ready"==e.status?["visitor"==e.from?a("Visitor",{attrs:{domain_id:e.domain_id,flow_id:e.destination,api_key:e.api_key}}):e._e(),"agent"==e.from?a("Agent",{ref:"agent",attrs:{app_name:"pbxplus",number:e.destination,is_make_call:e.is_make_call,is_start_timer:e.is_start_timer}}):e._e(),"voxdesk"==e.from&&e.enable?a("Voxdesk",{attrs:{app_name:e.from,agent_id:e.destination}}):e._e()]:e._e()],2)},r=[],i=(a("96cf"),a("1da1")),s=a("d4ec"),o=a("bee2"),_=function(){function e(){Object(s["a"])(this,e)}return Object(o["a"])(e,[{key:"getMedia",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=null,a={audio:!0},e.prev=2,e.next=5,navigator.mediaDevices.getUserMedia(a);case 5:return t=e.sent,e.abrupt("return",{stream:t,msg:"",status:"ready"});case 9:return e.prev=9,e.t0=e["catch"](2),e.abrupt("return",{error:e.t0,msg:"Please provide permissions to make call",status:"permission_pending"});case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),c=new _,l=a("1eed"),u=a("b9ba"),d=a("f154"),m=a("d13d"),p=a("a78e"),f=a.n(p),b=a("7f2c"),h={components:{Agent:l["default"],Visitor:u["default"],PermissionMessage:d["default"],Voxdesk:m["default"]},data:function(){return{status:"new",from:"",api_key:"",destination:0,loadType:"",enable:!1,is_make_call:!0,is_start_timer:!0}},created:function(){var e=this;window.addEventListener("message",(function(t){console.log("message",t),"iframe"==t.data.loadType&&e.setCookie(t.data.jwt),"make-call"==t.data.loadType&&(window.self=e,e.destination=t.data.number,e.$refs.agent.number=e.destination,e.$refs.agent.$refs.keypad.phone_number=e.destination,e.$refs.agent.initiateCall()),"incomming"==t.data.loadType&&b["a"].$emit("incoming",t.data)})),"number"==this.$route.params.destination&&(this.is_start_timer=!1,this.is_make_call=!1)},mounted:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c.getMedia();case 2:t=e.sent,"visitor"==this.$route.params.from&&(this.domain_id=this.$route.query.domain_id),this.status=t.status,this.from=this.$route.params.from,this.destination=this.$route.params.destination,this.api_key=this.$route.params.api_key;case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{setCookie:function(e){var t={jwt:e};localStorage.setItem("token",JSON.stringify(t)),f.a.set("token",t,{secure:!0,sameSite:"None"}),this.enable=!0}},destroyed:function(){localStorage.removeItem("token")}},g=h,v=a("2877"),k=Object(v["a"])(g,n,r,!1,null,null,null);t["default"]=k.exports},d13d:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Agent",{attrs:{isLoad:"enable",number:e.agent_id,app_name:e.app_name},on:{callConnected:e.callConnected}})],1)},r=[],i=a("1eed"),s=a("2cb9"),o={components:{Agent:i["default"]},props:{agent_id:{type:String},app_name:{type:String}},data:function(){return{enable:!1}},mounted:function(){s["a"].$on("getVoicemailStatus",(function(e){e(!1)}))},methods:{callConnected:function(){console.log("Call connected"),parent.postMessage({isCampaignStart:!0},"*")}}},_=o,c=a("2877"),l=Object(c["a"])(_,n,r,!1,null,null,null);t["default"]=l.exports},f086:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"width-400"},[a("b-card",{attrs:{"body-class":"p-4"}},[a("b-form",{ref:"form",on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[a("b-form-group",{attrs:{id:"input-group-1",label:"Enter Name","label-for":"input-1"}},[a("b-form-input",{attrs:{type:"text",id:"input-1",placeholder:"Enter Name",required:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("b-form-group",{attrs:{id:"input-group-2",label:"Enter Phone Number","label-for":"input-2"}},[a("VueTelInput",{on:{"country-changed":e.countryChanged},model:{value:e.form.number,callback:function(t){e.$set(e.form,"number",t)},expression:"form.number"}})],1),a("b-form-group",{staticClass:"mb-3 pb-1 mt-3",attrs:{label:"Call Now or Later"}},[a("b-form-select",{staticClass:"mb-0",attrs:{options:e.sendType,required:""},model:{value:e.form.send_type,callback:function(t){e.$set(e.form,"send_type",t)},expression:"form.send_type"}})],1),"Scheduled"==e.form.send_type?a("b-row",[a("b-col",{attrs:{md:"12"}},[a("b-form-group",{attrs:{label:"Call back time"}},[a("b-form-input",{staticClass:"form-control pr-2",attrs:{type:"datetime-local",id:"callbacktime",required:""},model:{value:e.form.call_back_time,callback:function(t){e.$set(e.form,"call_back_time",t)},expression:"form.call_back_time"}})],1)],1),a("b-col",{staticClass:"mt-2",attrs:{lg:"12"}},[a("label",[e._v("Timezone")]),a("b-form-select",{attrs:{id:"input-3",options:e.getTimezones(),required:""},model:{value:e.form.timezone,callback:function(t){e.$set(e.form,"timezone",t)},expression:"form.timezone"}})],1)],1):e._e(),a("div",{staticClass:"d-flex justify-content-end border-top mt-4 pt-4"},[a("b-button",{attrs:{type:"submit",variant:"primary px-5",disabled:e.isDisabled}},[e._v("Submit")])],1),a("p",{staticClass:"mb-0 text-right mt-2 text-primary",class:e.errorClass},[e._v(e._s(e.message))])],1)],1)],1)},r=[],i=(a("96cf"),a("1da1")),s=a("f62e"),o=a("2ae6"),_=a("7f45"),c=a.n(_),l={components:{VueTelInput:s["a"]},props:["domain_id","api_key","call_flow_id"],data:function(){return{form:{name:"",number:"",timezone:"",api_key:"",call_flow_id:"",domain_id:"",message:"",call_back_time:"",send_type:"",country_code:""},isDisabled:!1,errorClass:"",message:"",sendType:[{value:"Call now",text:"call now"},{value:"Scheduled",text:"call later"}]}},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.form.timezone=c.a.tz.guess();case 1:case"end":return t.stop()}}),t)})))()},methods:{countryChanged:function(e){this.form.country_code=e.dialCode},getTimezones:function(){var e=c.a.tz.names();return e.unshift({text:"Select timezone",value:""}),e},onSubmit:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.form.domain_id=e.domain_id,e.form.call_flow_id=e.call_flow_id,e.form.api_key=e.api_key,e.message="saving..",e.isDisabled=!1,"Call now"!=e.form.send_type){t.next=12;break}return t.next=8,o["a"].add(e.form);case 8:a=t.sent,e.message="saved",t.next=16;break;case 12:return t.next=14,o["a"].add(e.form);case 14:a=t.sent,e.message="saved";case 16:a.Status?("Call now"==e.form.send_type?e.message="Call_now_success_helptext":e.message="Call_later_success_helptext",e.errorClass="text-primary"):void 0==a.err.response&&(e.message=a.err.message,e.errorClass="text-danger",e.isDisabled=!1),setTimeout((function(){e.message=""}),2e3);case 18:case"end":return t.stop()}}),t)})))()}}},u=l,d=a("2877"),m=Object(d["a"])(u,n,r,!1,null,null,null);t["default"]=m.exports},f154:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"d-flex flex-column justify-content-center align-items-center p-4"},[a("b-spinner",{attrs:{variant:"primary",label:"Spinning"}}),a("p",{staticClass:"mb-0 text-muted text-center mt-3"},[e._v("Please grant access to your webcam and micrphone so that you can use in your dialer")])],1)},r=[],i=a("2877"),s={},o=Object(i["a"])(s,n,r,!1,null,null,null);t["default"]=o.exports}}]);
//# sourceMappingURL=dialer.ea7a1e43.js.map